<div class="object-role-staff-cpn full-height">
  <div class="col-lg-12 pd-0" >
    <div class="row h-100">
      <div class="col-lg-6 p-l-0 p-r-5 d-flex">
        <div class="card mdbt" style="margin-bottom: 0 !important;">
          <!-- searching -->
          <form autocomplete="off" novalidate>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <div class="row">
                    <div class="col-md-4 labrole">
                      <label for="">{{'management.target.filter.staff' | translate}}</label>
                    </div>
                    <div class="col-md-8">
                      <input matInput class="input-search" name="code" [(ngModel)]="mobjSearchStaff.code">
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="row">
                    <div class="col-md-4 labrole">
                      <label for="">{{'management.dashboard.toggle.unit' | translate}}</label>
                    </div>
                    <div class="col-md-8">
                      <input matInput class="input-search" name="shopcode" [(ngModel)]="mobjSearchStaff.shopcode">
                    </div>
                  </div>
                </div>
              </div>

              <br>
              <div class="row">
                <div class="col-md-6">
                  <div class="row">
                    <div class="col-md-4 labrole">
                      <label for="">{{'management.objectrole.listObject' | translate}}</label>
                    </div>
                    <div class="col-md-8">
                      <input matInput [readonly]='mobjSearchStaff.isHaveRole == 0' class="input-search" name="role"
                        [(ngModel)]="mobjSearchStaff.role">
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="row">
                    <div class="col-md-4 labrole">
                      <label for="">{{'management.rolestaff.filter' | translate}}</label>
                    </div>
                    <div class="col-md-8">
                      <select class="input-search" name="hasrole" (click)="resetrole()"
                        [(ngModel)]="mobjSearchStaff.isHaveRole">
                        <option value="0">{{'management.rolestaff.haventrole' | translate}}</option>
                        <option value="1">{{'management.rolestaff.haverole' | translate}}</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
              <br>

              <div class="row">
                <div class="col-md-12 d-flex justify-content-center flex-wrap">
                  <button class="btn btn-primary click-btn mb-2 mx-2" (click)="clickSearch()">
                    <i class="fa fa-search"></i> {{'management.target.button.search' | translate}}</button>
                </div>
              </div>

            </div>
          </form>

          <!-- grid -->

          <div class="p-d-5">
            <strong>{{'management.rolestaff.liststaff' | translate}}</strong>
          </div>

          <div class="card-body table-responsive p-d-0 table-role">
            <div class="table-reponsive max-heigh-40">
              <table class="table table-striped table-hover fixed">
                <thead class="header-table">
                  <tr>
                    <th>{{'management.target.table.header.order' | translate}}</th>
                    <th>{{'management.rolestaff.staffcode' | translate}}</th>
                    <th>{{'management.rolestaff.staffname' | translate}}</th>
                    <th>{{'management.warningconfig.ShopCode' | translate}}</th>
                  </tr>
                </thead>

                <tbody *ngIf="!marrStaffs || marrStaffs.length == 0">
                  <tr>
                    <td colspan="4" align="center" style="background: white">
                      {{'management.warningconfig.Nodata' | translate}}</td>
                  </tr>
                </tbody>
                <tbody *ngIf="marrStaffs && marrStaffs.length > 0">
                  <tr *ngFor="let staff of marrStaffs; index as i" [style.font-weight]="select == staff.id ? 'bold' : ''">
                    <td class="text-center" (click)="showRoleOfStaff(staff)">
                      {{i + 1 }}
                    </td>
                    <td (click)="showRoleOfStaff(staff)">
                      <div [tooltip]="staff.code">
                        {{ staff.code }}
                      </div>
                    </td>

                    <td (click)="showRoleOfStaff(staff)">
                      <div [tooltip]="staff.name">
                        {{ staff.name }}
                      </div>
                    </td>

                    <td (click)="showRoleOfStaff(staff)">
                      <div [tooltip]="staff.shopcode">
                        {{ staff.shopcode}}
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Roles -->

      <div class="col-lg-6 p-l-0 p-r-5 d-flex">
        <div class="card w-100" style="margin-bottom: 0 !important;">
          <div class="card-header">
            <div>
              <strong> {{'management.target.filter.staff' | translate}}:
                {{mobjStaff.name ? mobjStaff.name : ''}}</strong>
            </div>
          </div>
          <div class="card-body p-d-0 table-object">
            <div class="table-responsive max-heigh-80">
              <table class="table table-striped table-hover">
                <thead class="header-table">
                  <tr>
                    <th>{{'management.target.table.header.order' | translate}}</th>
                    <th>{{'management.objectrole.code' | translate}}</th>
                    <th>{{'management.objectrole.name' | translate}}</th>
                    <th>{{'management.objectrole.des' | translate}}</th>
                    <th class="text-center">
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" [(ngModel)]="mblncheckAll" [disabled]="!mobjStaff.id" id="call"
                          class="custom-control-input" (ngModelChange)="checkAll()">
                        <label class="custom-control-label" for="call">
                          <span></span>
                        </label>
                      </div></th>
                  </tr>
                </thead>

                <tbody *ngIf="!marrRoles || marrRoles.length == 0">
                  <tr>
                    <td colspan="5" align="center" style="background: white">
                      {{'management.warningconfig.Nodata' | translate}}</td>
                  </tr>
                </tbody>
                <tbody *ngIf="marrRoles && marrRoles.length >0">
                  <tr *ngFor="let role of marrRoles; index as j">
                    <td class="text-center">
                      {{ j + 1 }}
                    </td>
                    <td>
                      <div [tooltip]="role.code" class='text-over'>
                        {{ role.code }}
                      </div>
                    </td>

                    <td>
                      <div [tooltip]="role.name" class='text-over'>
                        {{ role.name }}
                      </div>
                    </td>

                    <td>
                      <div [tooltip]="role.description" class='text-over'>
                        {{ role.description }}
                      </div>
                    </td>

                    <td class="text-center">
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" [(ngModel)]="role.check" [disabled]="!mobjStaff.id" [id]="j+1"
                          class="custom-control-input" (ngModelChange)="checkSave()">
                        <label class="custom-control-label" [for]="j+1">
                          <span></span>
                        </label>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="w-100 mt-3 mb-1 d-flex justify-content-center">
            <div class="w-25 d-flex justify-content-center">
              <div>
                <button type="button" class="btn btn-primary mr-2 click-btn" [disabled]="!mobjStaff.id || checksave == 0"
                  (click)="showRoleOfStaff(mobjStaff)">
                  <i class="fa fa-times" aria-hidden="true"></i> {{'management.service.button.cancel' | translate}}
                </button>
              </div>

              <div>
                <button type="button"  class="btn btn-primary click-btn" [disabled]="!mobjStaff.id || checksave == 0"
                  (click)="confirmSave(confirm)">
                  <i class="fa fa-save" aria-hidden="true"></i> {{'management.service.button.save' | translate}}
                </button>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>
</div>

<ng-template #confirm>
  <div class="modal-body">
    <i style="font-size: 1.2em; color: #20a8d8" class="fa fa-question-circle"></i>
    <span class="mx-1">{{'management.warningconfig.ok?' | translate}}</span>
  </div>
  <div class="modal-footer">
    <button class="m-2 btn btn-secondary click-btn" (click)="back()"><i class="fa fa-times"></i>
      {{'management.warningconfig.No' | translate}}</button>
    <button class="m-2 btn btn-primary click-btn" (click)="save()"><i class="fa fa-check"></i>
      {{'management.warningconfig.Yes' | translate}}
    </button>
  </div>
</ng-template>