<div class="col-xl-12 target-detail-cpn p-d-0">
  <div class="card">
    <div class="card-body">
      <div class="form-group row align-items-center">
        <label class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.name' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <div [tooltip]="service.name" placement="bottom">
              <input *ngIf="service.id != 0" matInput [(ngModel)]="service.name" readonly>
              <input *ngIf="service.id == 0" matInput [value]="" readonly>
            </div>
          </mat-form-field>
        </div>

        <label class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.code' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput [(ngModel)]="service.code" readonly>
          </mat-form-field>
        </div>
      </div>

      <div class="form-group row align-items-center">
        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.parent' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput
              [value]="(service.parentId == 0 ? ('management.service.info.origin' | translate) : (parentService ? parentService.name : ''))"
              readonly>
          </mat-form-field>
        </div>

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.group' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput [value]="(service.id == 0 ? '' : (mobjGroup ? mobjGroup.name : ''))" readonly>
          </mat-form-field>
        </div>

      </div>

      <div class="form-group row align-items-center">


        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.channel' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <div [tooltip]="service.id == 0 ? '' : strTooltipChannels">
              <mat-select [value]="service.id == 0 ? '' : marrChannelCode" multiple disabled>
                <mat-select-trigger *ngIf="marrChannelsServiceFull && marrChannelsServiceFull.length > 0">
                  {{marrChannelsServiceFull ? marrChannelsServiceFull[0].name : ''}}
                  <span *ngIf="marrChannelsServiceFull.length > 1" class="example-additional-selection"
                    class="example-additional-selection">
                    ( {{marrChannelsServiceFull.length === 2 ? '...' : '...'}}
                    +{{marrChannelsServiceFull.length - 1}})
                  </span>
                </mat-select-trigger>
                <mat-option *ngFor="let channel of marrChannelsServiceFull" disabled [value]="channel.code">
                  {{channel.name}}
                </mat-option>
              </mat-select>
            </div>
          </mat-form-field>
        </div>

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.serviceCycle' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>

            <input matInput readonly [value]="service.serviceCycle == 0 ? ('management.service.info.program' | translate)
            : (service.serviceCycle == 1 ? ('management.service.info.serviceCycleType' | translate)
            : '')">
          </mat-form-field>
        </div>

      </div>

      <div class="form-group row align-items-center">

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.fromDate' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput [value]="service.fromDate |date:'dd/MM/yyyy'" readonly>
            <!-- <mat-datepicker-toggle matSuffix [for]="fromDate"></mat-datepicker-toggle>
            <mat-datepicker #fromDate></mat-datepicker> -->
          </mat-form-field>
        </div>

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.toDate' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput [value]="service.toDate |date:'dd/MM/yyyy'" readonly>
            <!-- <mat-datepicker-toggle matSuffix [for]="toDate" readonly></mat-datepicker-toggle>
            <mat-datepicker #toDate readonly></mat-datepicker> -->
          </mat-form-field>
        </div>



      </div>

      <div class="form-group row align-items-center">
        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.serviceType' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput readonly
              [value]="service.serviceType == 1 ? ('management.service.info.plan' | translate) : (service.serviceType == 0 ? ('management.service.info.nonPlan' | translate) : '')">
          </mat-form-field>
        </div>

        <!-- <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.serviceOrder' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput readonly [(ngModel)]="service.serviceOrder">
          </mat-form-field>
        </div> -->

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.unitCode' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput readonly [value]="(service.id == 0 ? '' : (unitOfService ? unitOfService.name : ''))">
          </mat-form-field>
        </div>

      </div>

      <div class="form-group row align-items-center">

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.status' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput readonly
              [value]="service.id == 0 ? '' : (service.status == '0' ? ('management.service.info.nonwork' | translate) : (service.status == '1' ? ('management.service.info.work' | translate) : ''))">
          </mat-form-field>
        </div>

        <label
          class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.calcType' | translate}}</label>
        <div class="col-xl-4 col-md-4 col-sm-12">
          <mat-form-field>
            <input matInput readonly
              [value]="service.id == 0 ? '' : (service.serviceCalcType == '0' ? 'Tính toán trực tiếp' : (service.serviceCalcType == '1' ? 'Cộng từ chỉ tiêu con' : ''))">
          </mat-form-field>
        </div>

      </div>

      <div class="form-group row align-items-center">


      </div>

      <div class="form-group row align-items-center">

        <label class="col-xl-2 col-md-2 col-sm-12 col-form-label">{{'management.service.info.exp' | translate}}</label>
        <label class="col-xl-10 col-md-10 col-sm-12">
          <a style="color: blue; text-decoration: underline; cursor: pointer;" (click)="downloadGuildEXP()">
            {{'management.service.button.guildExp' | translate}}
          </a>
        </label>
      </div>

      <div class="form-group row align-items-center">
        <div class="col-xl-12 col-md-12 col-sm-12">
          <mat-form-field class="text-mat">
            <textarea class="m-t-0" matInput cdkTextareaAutosize cdkAutosizeMinRows="1" cdkAutosizeMaxRows="10" readonly
              [(ngModel)]="service.exp" style="resize: none">
                  </textarea>
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="card-footer text-muted ">
      <div class="row">
        <div class="col-md-12 d-flex justify-content-center flex-wrap">
          <button class="btn btn-primary mb-2 mx-2 mt-4" [disabled]="mblCreateButton" (click)="openDialog()"><i
              class="fa fa-plus"></i>
            {{'management.service.button.add' | translate}} </button>
          <button class="btn btn-primary mb-2 mx-2 mt-4" (click)="download()"><i class="fa fa-download"></i>
            {{'management.target.button.download' | translate}}
          </button>
          <button class="btn btn-primary mb-2 mx-2 mt-4" (click)="confirm(template)"><i class="fa fa-upload"></i>
            {{'management.target.button.up' | translate}}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="w-100 py-2 font-weight-bold">
    {{'management.service.title.listSerive' | translate}}
  </div>
  <div class="w-100 detail-table">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="header-table">
          <tr>
            <th style="text-align: center;" *ngIf="service.length != 0 && service.id !== -1">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="customCheckAll" [checked]="checkBoxInPage"
                  (click)="checkInPage()">
                <label class="custom-control-label" for="customCheckAll">
                  <span></span>
                </label>
              </div>
            </th>

            <th style="text-align: center;" *ngIf="service.length == 0">
            </th>

            <th style="text-align: center;" *ngIf="service.id === -1">
            </th>

            <th>{{'management.service.history.no' | translate}}</th>
            <th>{{'management.service.info.id' | translate}}</th>
            <th>{{'management.service.info.name' | translate}}</th>
            <th>{{'management.service.info.parent' | translate}}</th>
            <th>{{'management.service.info.group' | translate}}</th>
            <th>{{'management.service.info.exp' | translate}}</th>
            <th>{{'management.service.info.status' | translate}}</th>
            <th></th>
          </tr>
        </thead>

        <tbody *ngIf="service.length == 0">
          <tr>
            <td colspan="9" align="center" style="background: white">
              {{'management.warningconfig.Nodata' | translate}}</td>
          </tr>
        </tbody>

        <tbody *ngIf="service.id == -1">
          <tr>
            <td colspan="8" align="center" style="background: white">
              {{'management.warningconfig.Nodata' | translate}}</td>
          </tr>
        </tbody>
        <tbody *ngIf="service.id != -1">
          <tr
            *ngFor="let children of marrChildenService | paginate: {id:'child', itemsPerPage: 10, currentPage: p }; index as i">
            <td [ngStyle]="{'text-align':children.grandchildren == '1' ? 'right' : 'center' }">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" [(ngModel)]="children.checkbox" [id]="children.id"
                  (click)="checkUnit(children)">
                <label class="custom-control-label" [for]="children.id">
                  <span></span>
                </label>
              </div>
            </td>
            <td (click)="viewService(children.id)">
              <div>
                {{children.grandchildren == '1' ? children.no : 1}}
              </div>
            </td>
            <td (click)="viewService(children.id)" style="text-align: center;">
              <div [tooltip]="children.id">
                {{children.id}}
              </div>
            </td>
            <td (click)="viewService(children.id)">
              <div [tooltip]="children.name">
                {{children.name}}
              </div>
            </td>
            <td (click)="viewService(children.id)">
              <div [tooltip]="children.grandchildren == 1 ? mobjServiceChoice.name :
            mobjServiceChoice.parentId == 0 ? ('management.service.info.origin' | translate) :
                       (parentServiceChoose ? parentServiceChoose.name : '')">
                {{ children.grandchildren == 1 ? mobjServiceChoice.name :
              mobjServiceChoice.parentId == 0 ? ('management.service.info.origin' | translate) :
                         (parentServiceChoose ? parentServiceChoose.name : '')}}
              </div>
            </td>
            <td (click)="viewService(children.id)">
              <div [tooltip]="children.grandchildren == 1 ? children.groupName :
            (mobjGroupChoose ? mobjGroupChoose.name : '')">
                {{ children.grandchildren == 1 ? children.groupName :
                  (mobjGroupChoose ? mobjGroupChoose.name : '')}}
              </div>
            </td>
            <td (click)="viewService(children.id)">
              <div [tooltip]="children.exp">
                {{children.exp}}
              </div>
            </td>
            <td (click)="viewService(children.id)" style="text-align: center;">
              <div
                [tooltip]="children.status == 0 ? ('management.service.info.nonwork' | translate) : 'management.service.info.work' | translate">
                {{children.status == 0 ? ('management.service.info.nonwork' | translate) : 'management.service.info.work' | translate}}
              </div>
            </td>
            <td style="text-align: center;">
              <i class="fa fa-edit" tooltip="{{'management.service.button.edit' | translate}}"
                (click)="editService(children)" style="cursor: pointer;"></i>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="total-row" *ngIf="marrChildenService.length > 0">
        <div class="card-body"
          style="background:#fff; font-weight: normal; padding-top: 0 !important; padding-bottom: 0 !important;">
          <div class="row">

            <div class="col-xl-4 col-md-4 col-sm-12 col-form-label"> {{'management.warningconfig.from' | translate}}
              {{recordInPageMin}} {{'management.warningconfig.to' | translate}} {{recordInPage}}
              {{ 'management.service.form.inTotal' | translate}}
              {{marrChildenService.length}} {{'management.warningconfig.record' | translate}}
            </div>

            <div class="col-xl-8 col-md-8 col-sm-12 col-form-label">
              <ul style="float:right;" class="pagination" *ngIf="marrChildenService">
                <pagination-controls *ngIf="marrChildenService.length > 0" id="child"
                  previousLabel="{{'management.target.table.pager.previous' | translate}}"
                  nextLabel="{{'management.target.table.pager.next' | translate}}" (pageChange)="pageChanged($event)">
                </pagination-controls>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="w-100 d-flex justify-content-center">
        <div class="w-25 d-flex justify-content-center">
          <div *ngIf="service.id !== -1">
            <button *ngIf="service.length != 0" type="button" class="btn btn-primary mr-2 click-btn"
              [disabled]="!mblLockHidden" (click)="confirmLock(lock)" style="width: 95px;"
              tooltip="{{'management.service.info.lock' | translate}}">
              <i class="fa fa-lock" aria-hidden="true"></i> {{'management.service.info.lock' | translate}}
            </button>
          </div>

          <div *ngIf="service.id !== -1">
            <button *ngIf="service.length != 0" type="button" class="btn btn-primary click-btn"
              [disabled]="!mblUnlockHidden" (click)="confirmUnLock(unlock)"
              tooltip="{{'management.service.info.unLock' | translate}}">
              <i class="fa fa-unlock-alt" aria-hidden="true"></i> {{'management.service.info.unLock' | translate}}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #template>
    <div class="modal-header">
      <h4 class="modal-title pull-left title-upload">{{'management.service.title.configService' | translate}}</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="onBack()" size="6MB">
        <span aria-hidden="true" style="border: none">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <input style="cursor: pointer" class="input-upload" type="file" accept=".xlsx" name="file"
        (change)="selectFile($event)" size="6MB">
      <div *ngIf="mblnCheckFileNull == true" style="color: red">{{'management.target.modal.fileNull' | translate}}
      </div>

      <div *ngIf="mnbrCode == 200 && mstrMessageUpload == null && mblnIsSelectFile && mnbrSumRecord == 0"
        style="color: red">
        {{'management.service.error.emptyExcel' | translate}}
      </div>

      <div *ngIf="mnbrCode == 200 && mstrMessageUpload == null && mblnIsSelectFile && mnbrSumRecord > 0"
        style="color: #20a8d8">
        {{'management.target.modal.uploaded' | translate}}: {{mnbrSumSuccessfulRecord}}/{{mnbrSumRecord}}
        {{'management.target.table.record.record' | translate}}</div>
      <div *ngIf="mnbrCode == 200 && mstrMessageUpload == null && mblnIsSelectFile && mnbrSumRecord > 0">
        {{'management.target.modal.resultDownload' | translate}}
        (<a href="#/target-management" *ngIf="mblnIsClickHere" (click)="downloadResult(mstrResultFileName)"
          class="a-upload">{{'management.target.modal.here' | translate}}</a>
        <a href="#/target-management" *ngIf="!mblnIsClickHere"
          (click)="downloadResult(mstrResultFileName)">{{'management.target.modal.here' | translate}}</a>)
      </div>
      <div *ngIf="mnbrCode == 200 && mstrMessageUpload && mblnIsSelectFile" style="color: red">{{mstrMessageUpload}}
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary click-btn-upload" (click)="onBack()"><i class="fa fa-sign-out"></i>
        {{'management.target.button.back' | translate}}
      </button>
      <button (click)="upLoad()" class="btn btn-primary click-btn-upload" type="button"><i class="fa fa-upload"></i>
        {{'management.target.button.upload' | translate}}
      </button>
    </div>
  </ng-template>

  <ng-template #lock>

    <div class="row" style="margin-right: 0 !important; margin-left: 0 !important;">
      <div class="col-md-10 modal-body">
        <span class="" *ngIf="dialogCheckAll"> <i style="font-size: 1.2em; color: #20a8d8"
            class="fa fa-question-circle"></i>
          {{'management.service.message.cofirmUnlockP' | translate}}</span>
        <span class="" *ngIf="!dialogCheckAll"> <i style="font-size: 1.2em; color: #20a8d8"
            class="fa fa-question-circle"></i>
          {{'management.service.message.cofirmLock' | translate}}</span>
      </div>

      <div class="col-md-2 modal-body">
        <button type="button" class="close pull-right" aria-label="Close" (click)="onBackConfirm()" size="6MB">
          <span aria-hidden="true" style="border: none">&times;</span>
        </button>
      </div>
    </div>

    <div class="modal-footer">
      <button style="width: 85.64px;" type="button" class="btn btn-secondary click-btn-upload" data-dismiss="modal"
        (click)=onBackConfirm()><i class="fa fa-times"></i>
        {{'management.service.button.cancel' | translate}}
      </button>
      <button *ngIf="!dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(0,1)><i class="fa fa-check"></i>
        {{'management.service.button.Yes' | translate}}
      </button>
      <button *ngIf="dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(0,0)><i class="fa fa-check"></i>
        {{'management.service.button.No' | translate}}
      </button>
      <button *ngIf="dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(0,1)><i class="fa fa-check"></i>
        {{'management.service.button.Yes' | translate}}
      </button>

    </div>
  </ng-template>

  <ng-template #unlock>
    <div class="row" style="margin-right: 0 !important; margin-left: 0 !important;">
      <div class="col-md-10 modal-body">
        <span class="" *ngIf="dialogCheckAll"> <i style="font-size: 1.2em; color: #20a8d8"
            class="fa fa-question-circle"></i>
          {{'management.service.message.cofirmLockP' | translate}}</span>
        <span class="" *ngIf="!dialogCheckAll"> <i style="font-size: 1.2em; color: #20a8d8"
            class="fa fa-question-circle"></i>
          {{'management.service.message.cofirmLock' | translate}}</span>
      </div>

      <div class="col-md-2 modal-body">
        <button type="button" class="close pull-right" aria-label="Close" (click)="onBackConfirm()" size="6MB">
          <span aria-hidden="true" style="border: none">&times;</span>
        </button>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary click-btn-upload" (click)=onBackConfirm()
        style="width: 85.64px;"><i class="fa fa-times"></i>
        {{'management.service.button.cancel' | translate}}
      </button>
      <button *ngIf="!dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(1,1)><i class="fa fa-check"></i>
        {{'management.service.button.Yes' | translate}}
      </button>
      <button *ngIf="dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(1,0)><i class="fa fa-check"></i>
        {{'management.service.button.No' | translate}}
      </button>
      <button *ngIf="dialogCheckAll" style="width: 85.64px;" class="btn btn-primary click-btn-upload" type="button"
        (click)=acceptLock(1,1)><i class="fa fa-check"></i>
        {{'management.service.button.Yes' | translate}}
      </button>

    </div>
  </ng-template>
</div>
